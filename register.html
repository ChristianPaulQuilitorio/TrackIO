// Import Firebase modules
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
// Firebase configuratione>
const firebaseConfig = {t" href="style.css"> <!-- Link to external CSS -->
    apiKey: "AIzaSyC9z8Amm-vlNcbw-XqEnrkt_WpWHaGfwtQ",pt>
    authDomain: "trackio-f5b07.firebaseapp.com",
    projectId: "trackio-f5b07",
    storageBucket: "trackio-f5b07.firebasestorage.app",
    messagingSenderId: "1083789426923",
    appId: "1:1083789426923:web:c372749a28e84ff9cd7eae",
    measurementId: "G-DSPVFG2CYW"e" class="messageDiv" style="display:none"></div> <!-- Error message display -->
};          <label for="rFirstName">First Name</label>
            <input type="text" id="rFirstName" placeholder="First Name" required>
// Initialize Firebase="rLastName">Last Name</label>
const app = initializeApp(firebaseConfig);me" placeholder="Last Name" required>
            <label for="rEmail">Email</label>
// Test Firebase initialization id="rEmail" placeholder="Email" required>
console.log("Firebase App Name:", app.name); // Should log "[DEFAULT]" if Firebase is initialized correctly
            <input type="password" id="rPassword" placeholder="Password" required>
// Initialize Firebase Authentication"submitSignUp" class="btn">Sign Up</button>
const auth = getAuth(app);
        <div class="toggle-link">
// Initialize Firestorehave an account? <a href="index.html" id="show-login">Login</a></p>
const db = getFirestore(app);
    </div>
// Set persistence to local (persists even after the browser is closed)
setPersistence(auth, browserLocalPersistence)s"></script> <!-- Link to external JavaScript -->
    .then(() => {
        console.log("Authentication state persistence set to local.");    })    .catch((error) => {        console.error("Error setting persistence:", error);    });// Toggle between login and register formsconst loginFormContainer = document.getElementById('login-form-container');const registerFormContainer = document.getElementById('register-form-container');const showRegisterLink = document.getElementById('show-register');const showLoginLink = document.getElementById('show-login');if (showRegisterLink) {    showRegisterLink.addEventListener('click', (e) => {        e.preventDefault();        loginFormContainer.style.display = 'none';        registerFormContainer.style.display = 'block';    });}if (showLoginLink) {    showLoginLink.addEventListener('click', (e) => {        e.preventDefault();        registerFormContainer.style.display = 'none';        loginFormContainer.style.display = 'block';    });}// Function to display messagesfunction showMessage(message, divId) {    const messageDiv = document.getElementById(divId);    messageDiv.style.display = "block";    messageDiv.innerHTML = message;    messageDiv.style.opacity = 1;    setTimeout(() => {        messageDiv.style.opacity = 0;        messageDiv.style.display = "none";    }, 5000);}// Event listener for company registrationdocument.addEventListener('DOMContentLoaded', () => {    const registerButton = document.getElementById('submitCompanyRegister');    const registerMessage = document.getElementById('companyRegisterMessage');    if (registerButton) {        registerButton.addEventListener('click', async (event) => {            event.preventDefault(); // Prevent default button behavior            const companyName = document.getElementById('cName').value.trim();            const email = document.getElementById('cEmailRegister').value.trim();            const password = document.getElementById('cPasswordRegister').value.trim();            console.log("Attempting to register company with email:", email);            // Validate input fields            if (!companyName || !email || !password) {                showMessage("All fields are required.", 'companyRegisterMessage');                return;            }            // Validate password length            if (password.length < 6) {                showMessage("Password must be at least 6 characters long.", 'companyRegisterMessage');                return;            }            try {                // Create company user with email and password                const userCredential = await createUserWithEmailAndPassword(auth, email, password);                const user = userCredential.user;                console.log('Company registered successfully with UID:', user.uid, 'and email:', user.email);                // Add company data to Firestore                await setDoc(doc(db, "companies", user.uid), {                    companyName: companyName,                    email: email,                    uid: user.uid,                    proofUploaded: false, // Default to false                    businessLocation: null, // Default to null                    openForOJT: false // Default to false                });                // Store user ID in sessionStorage                sessionStorage.setItem('userId', user.uid);                console.log("Company data saved to Firestore");                showMessage("Company registered successfully! Redirecting to verification...", 'companyRegisterMessage');                // Redirect to verification page                setTimeout(() => {                    window.location.href = "company-verification.html";                }, 2000);            } catch (error) {                console.error("Error during registration:", error);                if (error.code === 'auth/email-already-in-use') {                    showMessage("Email already in use.", 'companyRegisterMessage');                } else if (error.code === 'auth/invalid-email') {                    showMessage("Invalid email address.", 'companyRegisterMessage');                } else if (error.code === 'auth/weak-password') {                    showMessage("Password must be at least 6 characters long.", 'companyRegisterMessage');                } else {                    showMessage("Registration failed. Please try again.", 'companyRegisterMessage');                }            }        });    }    const loginButton = document.getElementById('submitCompanyLogin');    const loginMessage = document.getElementById('companyLoginMessage');    if (loginButton) {        loginButton.addEventListener('click', async (event) => {            event.preventDefault(); // Prevent default button behavior            const email = document.getElementById('cEmail').value.trim();            const password = document.getElementById('cPassword').value.trim();            console.log("Attempting to log in company with email:", email);            try {                // Sign in company user with email and password                const userCredential = await signInWithEmailAndPassword(auth, email, password);                const user = userCredential.user;                console.log('Company logged in successfully with UID:', user.uid, 'and email:', user.email);                // Store user ID in sessionStorage                sessionStorage.setItem('userId', user.uid);                // Fetch company data from Firestore                const companyDocRef = doc(db, "companies", user.uid);                const companyDoc = await getDoc(companyDocRef);                if (companyDoc.exists()) {                    const companyData = companyDoc.data();                    console.log("Company data from Firestore:", companyData);                    // Check if verification is complete                    if (!companyData.proofUploaded || !companyData.businessLocation) {                        console.log("Company verification incomplete. Redirecting to verification page...");                        window.location.href = "company-verification.html";                    } else {                        console.log("Company verification complete. Redirecting to dashboard...");                        showMessage("Login successful! Redirecting...", 'companyLoginMessage');                        // Redirect to Company dashboard                        setTimeout(() => {                            window.location.href = "company-dashboard.html";                        }, 2000);                    }                } else {                    console.error("No company data found in Firestore for UID:", user.uid);                    showMessage("Company data not found. Please contact support.", 'companyLoginMessage');                }            } catch (error) {                console.error("Error during login:", error.code, error.message, error);                if (error.code === 'auth/user-not-found') {                    showMessage("No company found with this email.", 'companyLoginMessage');                } else if (error.code === 'auth/wrong-password') {                    showMessage("Incorrect password. Please try again.", 'companyLoginMessage');                } else if (error.code === 'auth/invalid-email') {                    showMessage("Invalid email address. Please check and try again.", 'companyLoginMessage');                } else if (error.code === 'auth/too-many-requests') {                    showMessage("Too many failed login attempts. Please try again later.", 'companyLoginMessage');                } else {                    showMessage(`Login failed: ${error.message}`, 'companyLoginMessage');                }            }
        });
    }
});